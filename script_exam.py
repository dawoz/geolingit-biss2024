# %% [markdown]
# <a href="https://colab.research.google.com/github/crux82/BISS-2024/blob/main/BISS-2024_LAB-2.1_ExtremITA_data_encoder.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a>

# %% [markdown]
# ## Camoscio VS Minerva LLMs comparison when finetuned on the GeoLingIt dataset
# 
# The code is split into 4 steps, reflecting the following process:
# - Step 1 - Encoding the data
# - Step 2 - Training the models
# - Step 3 - Inference: generating answers
# - Step 4 - Deconding the data

# %% [markdown]
# ## Step 1 - Encoding the data
# 
# In this Notebook we will see the encoding part of the data, given that we have some datasets each of which in its own format, in order to transform it into a sequence to sequence format. We will save the data on a file for next steps.

# %% [markdown]
# # The workflow
# 
# In EVALITA we have a lot of datasets (22 tasks), each of which in a different format. The annotated data consists of a straightforward tab-delimited text file:
# 
# 
# ```
# <DOCID>|t|<TEXT>
# <DOCID>  REL  <RML_START>-<RML_END>  <EVENT_START>-<EVENT_END>  <RML_TEXT>  <EVENT_TEXT>
# <DOCID>  REL  <RML_START>-<RML_END>  <EVENT_START>-<EVENT_END>  <RML_TEXT>  <EVENT_TEXT>
# 
# <DOCID>|t|<TEXT>
# <DOCID>  REL  <RML_START>-<RML_END>  <EVENT_START>-<EVENT_END>  <RML_TEXT>  <EVENT_TEXT>
# ```
# 
# The **objective** here is to transform this data for the LLaMA model, so we need to:
# 1. Transform data into sequence-to-sequence format, in order to feed it to the LLaMA model:  
#   a. Read original data with pandas  
#   b. Take the text after `|t|` and save it  
#   c. Parse every relation `REL` into a sequence
# 2. Save it on file
# 
# ## Input
# The "input" of the Notebook is a file in the PubTator format, as given from the challenge.
# 
# ## Output
# The "output" (i.e. the result) of this Notebook is a simple txt file delimited by tabs, with four columns:
# - id
# - task name, from which the natural language task description is generated
# - input text
# - expected output

# %%
import random
from os.path import isdir
from os import mkdir, makedirs
import spacy
import re
import csv
import math
import transformers
from transformers import LlamaTokenizer, LlamaForCausalLM
import csv
import json

from peft import (
    LoraConfig,
    get_peft_model,
    prepare_model_for_kbit_training,
)

import torch
from datasets import load_dataset
import pandas as pd

# %%
import warnings
warnings.filterwarnings('ignore')

# %% [markdown]
# Path to the folder 'GeoLingIt' (probably should be modified based on the user executing this notebook)

# %%
relPath = '.'
TASK = "geolingit"
MODEL = "LLaMA"
TRAIN_DEV_SPLIT = 0.05

random.seed(23)

# %% [markdown]
# # How to generate the dataset
# 
# Once you have collected all the data you can encode them into the dataset format for our model, using the `encode` function.  
# [On our Github repository](https://github.com/crux82/ExtremITA/tree/main/tasks) you can find all the others, but we report the `encoder` only for the CLinkaRT task:

# %%
nlp = spacy.load("it_core_news_sm", disable=["lemmatizer", "tagger"])



def clean_input_text(text):
    text = re.sub(r'\t+', ' ', re.sub(r'\n+', ' ', re.sub(r'\s+', " ", text)))
    text = text.rstrip()
    return text

def encode():
    if not isdir(f"out/{TASK}"):
        makedirs(f"out/{TASK}")

    for split in ['dev', 'train']:
        data = dict()

        with open(f"{relPath}/GeoLingIt/subtask_a/{split}_a.tsv", encoding="utf-8") as f:
            reader = csv.DictReader(f, delimiter="\t", quoting=csv.QUOTE_NONE)
            for row in reader:
                text = clean_input_text(row['text'])
                label = row['region']
                data[row['id']] = {
                    'text': text,
                    'label': label,
                }

        with open(f"{relPath}/GeoLingIt/subtask_b/{split}_b.tsv", encoding="utf-8") as f:
            reader = csv.DictReader(f, delimiter="\t", quoting=csv.QUOTE_NONE)
            for row in reader:
                latitude = math.floor(eval(row['latitude'])*100)/100.
                longitude = math.floor(eval(row['longitude'])*100)/100.
                data[row['id']]['latitude'] = latitude
                data[row['id']]['longitude'] = longitude

        with open(f"out/{TASK}/{split}.txt", "w", encoding="utf-8") as f_o:
            for id, features in data.items():
                f_o.write(f"{id}\t{TASK}\t{features['text']}\t[regione] {features['label']} [geo] {features['latitude']} {features['longitude']}\n")



# %% [markdown]
# It will generate a file for the task. In order to fine-tune the model you should merge them into one single file and split them into `train.txt` and `dev.txt`. Here we will use a subset of the training, with 100 examples per task.  
# These files are made of 4 columns (with a tab character as a delimiter) without any header:
# - id
# - task name, from which the natural language task description is generated
# - input text
# - expected output

# %%
with open(f"{relPath}/GeoLingIt/subtask_a/train_a.tsv", "r", encoding='utf-8') as f:
  lines = f.readlines()
  for i, line in enumerate(lines):
    print(line)
    if i > 3:
      break

# %%
encode()

# %% [markdown]
# Let's open the newly created file and see what's inside

# %%
with open(f"out/{TASK}/train.txt", "r") as f:
  lines = f.readlines()
  print(lines[0])
  print(lines[8])

# %% [markdown]
# Generating text in the ad-hoc form

# %%
# TODO We will probably add here the geolingit variation with the regional capital coordinates
def target_answer_to_text(target_text: str, task: str):
    if task == "geolingit":
        return target_text
    else:
        return "task sconosciuto"

def target_text_to_answer(target_text: str, task: str):
    if task == "geolingit":
        return target_text
    else:
        return "task sconosciuto"

def task_to_prompt(task: str):
    if task == "geolingit":
        return "Scrivi la regione di appartenenza di chi ha scritto questo testo, seguito dalla latitudine, seguita dalla longitudine."
    else:
        return "task sconosciuto"


 ################ GENERATE METHODS ################
def generate_prompt_pred(instruction, input_):
    return f"""Di seguito è riportata un'istruzione che descrive un task, insieme ad un input che fornisce un contesto più ampio. Scrivete una risposta che completi adeguatamente la richiesta.
### Istruzione:
{instruction}
### Input:
{input_}
### Risposta:"""

def generate_prompt_str(instruction, input_):
    return f"""Di seguito è riportata un'istruzione che descrive un task, insieme ad un input che fornisce un contesto più ampio. Scrivete una risposta che completi adeguatamente la richiesta.
### Istruzione:
{instruction}
### Input:
{input_}
### Risposta:"""

def generate_prompt(data_point):
    if data_point["input"]:
        return f"""Di seguito è riportata un'istruzione che descrive un task, insieme ad un input che fornisce un contesto più ampio. Scrivete una risposta che completi adeguatamente la richiesta.
### Istruzione:
{data_point["instruction"]}
### Input:
{data_point["input"]}
### Risposta:
{data_point["output"]}"""
    else:
        return f"""Di seguito è riportata un'istruzione che descrive un task. Scrivete una risposta che completi adeguatamente la richiesta.
### Istruzione:
{data_point["instruction"]}
### Risposta:
{data_point["output"]}"""

# %% [markdown]
# ------------------------------
# ## Hyper-parameteres
# 
# Here we set all the hyper-parameters we need:
# - specify the device to exploit the GPU (`cuda`)
# - use the tokenizer for llama 7b
# - take the base model of Camoscio from [Huggingface](https://huggingface.co/sag-uniroma2/extremITA-Camoscio-7b)
# - the paths for our training and development set
# - we cut off the length of sentences to maximum `512` words and `1200` charachters
# - we set then the LoRA hyper-params:
#   - the rank `R` of the two matrices A and B
#   - the normalization factor `Alpha`
#   - the `dropout rate`
#   - the target modules, i.e. where to insert the LoRA modules: `q`, `k` and `v` for the attention and `o` for the final output layer.
# - `number of epochs` to train the model
# - `batch_size` is the global size of our batch of examples, but since we have a small GPU with only 15GB of memory, we need to scale this down, so we introduce 2 new concepts:
#   - `micro_batch_size` is the real size of the batch we will use, which will be smaller (usually 2,4,8)
#   - `gradient_accumulation_steps` how many steps (of batches) we want to accumulate the `loss` for before we update the parameters of the model. In this way we simulate a bigger `batch_size` by accumulating the `loss` for more than one iteration, and then we update the model.
# - the `learning_rate`, which controls the intensity of the update
# - the `warmup_ratio`, as we are using a scheduler for the learning rate, i.e. it will not be fixed during the whole training, but will vary based on the time.
# 
# Just to give an idea, usually you will set the learning rate to a fixed value and stick with it. That is the constant scheduler. There are different one, here after an image:
# 
# ![image.png](data:image/png;base64,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duvWLTo6OjU1dcSIEcK/DWnJkiUJCQn5+flXrlxZunRp69atT58+TdO06DrS3JiEVGouMXPUl0wqST6PQID/in+9j2wzR26w3mZsbCz69ws/sREvxOHo6GhlZTVs2DB8RTHr1lls8N+dqN8KDAzE7VdVVc2fP9/e3r5t27YTJkwoKipi0a45mpo5cyZ+mKaDg8PIkSOx+tI0LbqOGAEHUskIaOweIplUknwegQCzG/nQGhAAAkAACAABgwiAABuECSoBASAABIAAEGCXAAgwuzyhNSAABIAAEAACBhEAATYIE1QCAkAACAABIMAuARBgdnlCa0AACAABIAAEDCIAAmwQJnNXCgwM1L1wESEUGxtrbtPma7+ystLb21urC7in+fn5htjVquzh4WFjY6P3QE2AFhYWjo6O06ZN07qfWO+BsFOYBC5fvvzpp586OTlZWVnZ2NgMHDhwzZo19+/fN8VbgiDwDQKmNKJ17M8//4wQ6tevn9Z+fje9vb0R+mdud3/yYsslhNC8efP0tubu7s7MY1ZWVq6urqtWraqurtZbGXbSNP3PIAEOHglg/QgMDEz696usrIxHr0w0fffuXYSQt7e3Zjt37txJSkpSKpWaOxsqN1eAMcDY2FgfH5+2bdt26tRJ8xEODVmB/UIj8Pvvv7dp06Zfv36bN2+OjY09ffq0n59fz5493333XVNcTU1NvXHjhikt6B47YMAALDnJycm67/K1R0uAM5682HKmcQHu1asXnsNOnDgxadIkhNAXX3zBlmnptQMCLIgxxUojl8sF4Q1LTugV4Ga13VwB1gS4cuVKhNDOnTubZREq804gMTHRwsJi7NixWp/Sqqurjx8/zrt7mg7I5XKE0Pjx44UmM1oCrOmz6eXGBVjzZEBtbW2fPn0sLS2rqqpMtyvJFkCABTGsjQhwUFAQQujXX39lHF2xYgWzslJ+fj5CaM2aNT4+Pt27d7eysnr55Zejo6OZyjRNnz17dsSIEe3bt2/btu1rr71GURTzLrYbExPj6enZsWNHe3v79957T/MZSniZsCFDhrRr187Gxmb06NGajzjE54RzcnLGjRtnY2PTrVu3b775Bs+b2DHmfBRCCJ/909LU06dPT5o0qWvXrlZWVr179/7yyy/v3r2r5R5zvrrJU9CaAhwWFoYQWr16NdMaFERBYMKECW3atGlkrRWV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)

# %%
DEVICE = "cuda"
if MODEL == "LLaMA":
    TOKENIZER_MODEL = "yahma/llama-7b-hf"
    BASE_MODEL = "sag-uniroma2/extremITA-Camoscio-7b"
elif MODEL == "MINERVA": 
    TOKENIZER_MODEL = "yahma/llama-7b-hf"
    BASE_MODEL = "sag-uniroma2/extremITA-Camoscio-7b"

input_train_path = f"out/{TASK}/train.txt"
input_dev_path = f"out/{TASK}/dev.txt"
OUTPUT_DIR = f"LLaMinerva/{MODEL}"

CUTOFF_LEN = 512
CUT_INPUT_CHAR_LENGTH = 1200

task = "*"

LORA_R = 8
LORA_ALPHA = 16
LORA_DROPOUT= 0.05
LORA_TARGET_MODULES = [
    "q_proj",
    "k_proj",
    "v_proj",
    "o_proj",
]

EPOCHS = 10 # better 2 epochs
BATCH_SIZE = 32 #it would be better 128 but it may require too much GPU memory (original 32)
MICRO_BATCH_SIZE = 16 #it would be better 32 but it may require too much GPU memory (original 8)
GRADIENT_ACCUMULATION_STEPS = BATCH_SIZE // MICRO_BATCH_SIZE
LEARNING_RATE = 3e-4
WARMUP_RATIO = 0.1

tmp_train_file_name = "tmp_train.json"
tmp_dev_file_name = "tmp_dev.json"

# %% [markdown]
# 

# %% [markdown]
# ## Functions
# We will define now some functions in order to facilitate the readability of the Notebook.

# %%
#============================================
#               FUNCTIONS
#============================================

tokenizer = LlamaTokenizer.from_pretrained(TOKENIZER_MODEL)

#LOAD INPUT TSV files in the extremITA format
def load(input_file_path):
    dataset_df = pd.read_csv(input_file_path, header=None, usecols=[0,1, 2, 3], names=['0', '1', '2', '3'], \
                             sep="\t", quoting=csv.QUOTE_NONE, encoding='utf-8').astype(str)
    dataset_df = dataset_df.rename(
        columns={"0": "id", "1": "prefix", "2": "input_text", "3": "target_text"}
    )
    dataset_df = dataset_df[["id", "input_text", "target_text", "prefix"]]
    return dataset_df


# Notice: in the generate_and_tokenize_prompt function result["labels"] is rewritten
def tokenize(prompt, cutoff_len, add_eos_token=True):
    result = tokenizer(
        prompt,
        truncation=True,
        max_length=cutoff_len,
        padding=False,
        return_tensors=None,
    )
    if (
        result["input_ids"][-1] != tokenizer.eos_token_id
        and len(result["input_ids"]) < cutoff_len
        and add_eos_token
    ):
        result["input_ids"].append(tokenizer.eos_token_id)
        result["attention_mask"].append(1)

    result["labels"] = result["input_ids"].copy()

    return result

# Notice: result["labels"] is rewritten so that only the output is considered
def generate_and_tokenize_prompt(data_point, add_eos_token=True):
    full_prompt = generate_prompt(data_point)
    tokenized_full_prompt = tokenize(full_prompt, CUTOFF_LEN)

    user_prompt = generate_prompt_str(
        data_point["instruction"], data_point["input"]
    )
    tokenized_user_prompt = tokenize(
        user_prompt, CUTOFF_LEN, add_eos_token=add_eos_token
    )
    user_prompt_len = len(tokenized_user_prompt["input_ids"])

    if add_eos_token:
        user_prompt_len -= 1

    tokenized_full_prompt["labels"] = [
        -100
    ] * user_prompt_len + tokenized_full_prompt["labels"][
        user_prompt_len:
    ]  # could be sped up, probably
    return tokenized_full_prompt



def load_and_prepare_data(input_file_path: str, tasks):

    df = load(input_file_path)

    if isinstance(tasks, str):
        if(tasks != "*"):
            df = df[df["prefix"]==tasks]
    elif isinstance(tasks, list):
        tmp = None
        for task in tasks:
            if tmp == None:
                tmp = df[df["prefix"]==task]
            else:
                tmp += df[df["prefix"]==task]
        df = tmp

    print(df.target_text.value_counts())

    dataset_data = [
        {
            "instruction": task_to_prompt(row_dict["prefix"]),
            "input": row_dict["input_text"],
            "output": target_text_to_answer(row_dict["target_text"], row_dict["prefix"])
        }
        for row_dict in df.to_dict(orient="records")
    ]

    return dataset_data

def trim_long_input(json_input, cutoff_len=10000000):
    for json_data in json_input:
        json_data["input"] = json_data["input"][:cutoff_len]
    return json_input


# %% [markdown]
# ## Fine-tuning the LLM
# We first load the data that was already prepared then we cut the maximum length accordingly to the previous params.

# %%
#-------------------
#    LOAD DATA
#-------------------
train_data = load_and_prepare_data(input_train_path, task)
dev_data = load_and_prepare_data(input_dev_path, task)


with open(tmp_train_file_name, "w") as f:
   json.dump(train_data, f)
with open(tmp_dev_file_name, "w") as f:
   json.dump(dev_data, f)

json_train = load_dataset("json", data_files=tmp_train_file_name)
json_dev = load_dataset("json", data_files=tmp_dev_file_name)

# TRIM LONG INPUT
json_train["train"] = trim_long_input(json_train["train"], CUT_INPUT_CHAR_LENGTH)
json_dev["train"] = trim_long_input(json_dev["train"], CUT_INPUT_CHAR_LENGTH)

# %% [markdown]
# Now we need to load the model and its associated tokenizer. Choose here the number of bits for loading the models. Remember that lower bits mean lower precision, and thus a drop in performance.

# %%
bits = "4" #@param ["4", "8", "full"]

# %%
#-------------------
#    LOAD MODEL
#-------------------
# base model here, choose between 4, 8 bits or full precision
if bits == "8":
  model = LlamaForCausalLM.from_pretrained(
      BASE_MODEL,
      load_in_8bit=True,
      torch_dtype=torch.float16,
      device_map="auto",
  )
elif bits == "4":
  model = LlamaForCausalLM.from_pretrained(
      BASE_MODEL,
      load_in_4bit=True,
      torch_dtype=torch.float16,
      device_map="auto",
  )
else:
  model = LlamaForCausalLM.from_pretrained(
      BASE_MODEL,
      torch_dtype=torch.float16,
      device_map="auto",
  )



# we need to explicitly assign the ids for the pad token, begin and end of sentence here
tokenizer.pad_token_id = 0
tokenizer.bos_token_id = 1
tokenizer.eos_token_id = 2

# we will add the pad on the left side, as to simulate an older chat history for which we don't care anymore.
# More importantly we want the model to generate on the "right" side of the sentence, as to complete a request
tokenizer.padding_side = "left"


# PREPARE DATA
train_data = ( json_train["train"].shuffle().map(generate_and_tokenize_prompt) )
val_data = ( json_dev["train"].shuffle().map(generate_and_tokenize_prompt) )

# PREPARE MODEL and add the LoRA modules
model = prepare_model_for_kbit_training(model)
config = LoraConfig(
    r=LORA_R,
    lora_alpha=LORA_ALPHA,
    target_modules=LORA_TARGET_MODULES,
    lora_dropout=LORA_DROPOUT,
    bias="none",
    task_type="CAUSAL_LM",
)
model = get_peft_model(model, config)
model.print_trainable_parameters()

training_arguments = transformers.TrainingArguments(
    per_device_train_batch_size=MICRO_BATCH_SIZE,
    gradient_accumulation_steps=GRADIENT_ACCUMULATION_STEPS,
    warmup_ratio=WARMUP_RATIO,
    num_train_epochs=EPOCHS,
    learning_rate=LEARNING_RATE,
    fp16=True,
    logging_strategy = "steps",
    logging_steps=1,
    optim="adamw_torch",
    evaluation_strategy="epoch",
    save_strategy="epoch",
    output_dir=OUTPUT_DIR,
    save_total_limit=1,
    metric_for_best_model="eval_loss",
    load_best_model_at_end=True,
    label_names=["labels"]
)

data_collator = transformers.DataCollatorForSeq2Seq(
    tokenizer, pad_to_multiple_of=8, return_tensors="pt", padding=True
)

# istantiate a Trainer object using the hyper-params we defined earlier
trainer = transformers.Trainer(
    model=model,
    train_dataset=train_data,
    eval_dataset=val_data,
    args=training_arguments,
    data_collator=data_collator
)
model.config.use_cache = False

if torch.cuda.device_count() > 1:
    # keeps Trainer from trying its own DataParallelism when more than 1 gpu is available
    model.is_parallelizable = True
    model.model_parallel = True

# we need to explicitly assign the ids for the pad token, begin and end of sentence here
model.config.pad_token_id = 0
model.config.bos_token_id = 1
model.config.eos_token_id = 2

# speeds up training
if torch.__version__ >= "2":
    model = torch.compile(model)

# %%
#-------------------
#    TRAIN & SAVE
#-------------------

trainer.train()

model.save_pretrained(OUTPUT_DIR)

# %%
#import gc
#import torch
#del model
#gc.collect()
#torch.cuda.empty_cache()


